---
import PostTime from '@/components/PostTime.astro'

interface Post {
  data: {
    title: string
    abbrlink?: string
    published: Date
    lang?: string
  }
  slug?: string
  remarkPluginFrontmatter?: {
    minutes?: number
  }
}

// Receive posts parameter passed from outside
const { posts, lang: pageLang } = Astro.props

// Declare the type of props
export interface Props {
  posts: Post[]
  lang?: string
}

// 构建正确的链接路径
function getPostUrl(post: Post) {
  const postPath = post.data.abbrlink || post.slug
  // 如果是在语言文件夹下的页面，添加语言前缀
  return pageLang ? `/${pageLang}/posts/${postPath}/` : `/posts/${postPath}/`
}
---
<ul>
  {posts.map(post => (
    <li class="mt-4.375">

      {/* post title */}
      <a
        class="hover:c-primary"
        href={getPostUrl(post)}
        transition:name={`post-${post.data.abbrlink || post.slug}`}
        data-disable-transition-on-theme
      >
        {post.data.title}
      </a>

      {/* mobile post time */}
      <div
        class="uno-mobile-time"
        transition:name={`time-${post.data.abbrlink || post.slug}`}
        data-disable-transition-on-theme
      >
        <PostTime
          date={post.data.published}
          minutes={post.remarkPluginFrontmatter?.minutes}
        />
      </div>

      {/* desktop post time */}
      <div class="uno-desktop-time">
        <PostTime
          date={post.data.published}
          minutes={post.remarkPluginFrontmatter?.minutes}
        />
      </div>

    </li>
  ))}
</ul>
