---
import PostTime from '@/components/PostTime.astro'

interface Post {
  data: {
    title: string
    abbrlink?: string
    published: Date
  }
  // URL path automatically generated by Astro based on the filename
  slug?: string
  // Optional for robustness in case render() fails or plugin isn't applied
  remarkPluginFrontmatter?: {
    minutes?: number
  }
}

// Get post list and page language parameter from props
const { posts, lang } = Astro.props

export interface Props {
  posts: Post[]
  lang?: string
}

// Get multilingual post URL path
function getPostPath(post: Post) {
  // If abbrlink is set, it will be used instead of slug
  const postPath = post.data.abbrlink || post.slug
  // Add language prefix to URL if current page is in a language subdirectory
  return lang ? `/${lang}/posts/${postPath}/` : `/posts/${postPath}/`
}
---
<ul>
  {posts.map(post => (
    <li class="mt-4.375">

      {/* post title */}
      <a
        class="hover:c-primary"
        href={getPostPath(post)}
        transition:name={`post-${post.data.abbrlink || post.slug}`}
        data-disable-transition-on-theme
      >
        {post.data.title}
      </a>

      {/* mobile post time */}
      <div
        class="uno-mobile-time"
        transition:name={`mobile-time-${post.data.abbrlink || post.slug}`}
        data-disable-transition-on-theme
      >
        <PostTime
          date={post.data.published}
          minutes={post.remarkPluginFrontmatter?.minutes}
        />
      </div>

      {/* desktop post time */}
      <div
        class="uno-desktop-time"
        transition:name={`desktop-time-${post.data.abbrlink || post.slug}`}
        data-disable-transition-on-theme
      >
        <PostTime
          date={post.data.published}
          minutes={post.remarkPluginFrontmatter?.minutes}
        />
      </div>

    </li>
  ))}
</ul>
